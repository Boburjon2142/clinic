{% extends 'base.html' %}
{% block title %}Xarajatlar â€” Tasdiqlash{% endblock %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h3 class="mb-0">Xarajat so'rovlari</h3>
  </div>

  <div class="card neo-card p-2 mb-3">
    <div class="fw-semibold px-2 py-1">Kutilayotgan so'rovlar</div>
    <div class="table-responsive">
      <table class="table table-striped table-hover table-compact mb-0">
        <thead>
          <tr><th>Sana</th><th>Foydalanuvchi</th><th>Miqdor</th><th>Izoh</th><th class="text-end">Amallar</th></tr>
        </thead>
        <tbody>
          {% for it in pending %}
          <tr>
            <td>{{ it.created_at|date:'Y-m-d H:i' }}</td>
            <td>{{ it.requested_by.username }}</td>
            <td>{{ it.amount }}</td>
            <td>{{ it.comment|default:'-' }}</td>
            <td class="text-end">
              <form method="post" class="d-inline">
                {% csrf_token %}
                <input type="hidden" name="id" value="{{ it.id }}">
                <input type="hidden" name="action" value="approve">
                <button class="btn btn-sm btn-success">Tasdiqlash</button>
              </form>
              <form method="post" class="d-inline ms-1">
                {% csrf_token %}
                <input type="hidden" name="id" value="{{ it.id }}">
                <input type="hidden" name="action" value="reject">
                <button class="btn btn-sm btn-outline-danger">Rad etish</button>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="5" class="text-center">Kutilayotgan so'rovlar yo'q</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="card neo-card p-2">
    <div class="fw-semibold px-2 py-1">Yaqinda ko'rib chiqilgan</div>
    <div class="table-responsive">
      <table class="table table-striped table-hover table-compact mb-0">
        <thead>
          <tr><th>Sana</th><th>Foydalanuvchi</th><th>Miqdor</th><th>Izoh</th><th>Holat</th></tr>
        </thead>
        <tbody>
          {% for it in recent %}
          <tr>
            <td>{{ it.created_at|date:'Y-m-d H:i' }}</td>
            <td>{{ it.requested_by.username }}</td>
            <td>{{ it.amount }}</td>
            <td>{{ it.comment|default:'-' }}</td>
            <td>
              {% if it.status == 'approved' %}<span class="badge bg-success">Tasdiqlandi</span>
              {% elif it.status == 'rejected' %}<span class="badge bg-danger">Rad etildi</span>
              {% else %}<span class="badge bg-warning text-dark">Kutilmoqda</span>{% endif %}
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="5" class="text-center">Ma'lumot yo'q</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}

